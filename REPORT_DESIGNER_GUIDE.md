# 📊 报表设计及导出功能使用指南

## 🎯 功能概述

"报表设计及导出"是一个独立的可视化Excel设计器页面，让你可以像搭积木一样设计个性化的Excel报表模板。

## 🚀 访问方式

在系统左侧菜单中点击：**报表设计及导出**

## 🏗️ 界面布局

```
┌─────────────────────────────────────────────────────────────┐
│                    报表设计及导出                            │
│                使用可视化设计器创建个性化Excel报表模板         │
├─────────────────────────────────────────────────────────────┤
│                      工具栏                                  │
├─────────────────────────────────┬───────────────────────────┤
│                                │                           │
│        Luckysheet Excel         │      数据模块库           │
│        (真正的Excel界面)         │                           │
│                                │  ┌─────────────────────┐  │
│  A  B  C  D  E  F  G  H  I     │  │ 📊 每日数据模块(31列) │  │
│1 □  □  □  □  □  □  □  □  □     │  │  ├ 每日蔬菜类支出     │  │
│2 □  □  □  □  □  □  □  □  □     │  │  ├ 每日鲜肉类支出     │  │
│3 □  □  □  □  □  □  □  □  □     │  │  ├ 每日冷冻类支出     │  │
│4 □  □  □  □  □  □  □  □  □     │  │  └ ...              │  │
│5 □  □  □  □  □  □  □  □  □     │  └─────────────────────┘  │
│  ...                          │                           │
│                                │  ┌─────────────────────┐  │
│                                │  │ 🧮 汇总统计模块      │  │
│                                │  │  ├ 蔬菜类月度合计     │  │
│                                │  │  ├ 鲜肉类月度合计     │  │
│                                │  │  └ ...              │  │
│                                │  └─────────────────────┘  │
└─────────────────────────────────┴───────────────────────────┘
```

## 🧩 数据模块详解

### 📊 每日数据模块（31列）⭐ 核心功能
每个模块支持年月份选择，自动占用31列，对应1日到31日：

#### 🥬 蔬菜类支出模块
- **功能**：可选择某年某月的31天蔬菜类每日支出数据
- **操作**：点击模块 → 选择年月份 → 插入31列数据
- **数据格式**：`{2024-12-01.蔬菜类}` 到 `{2024-12-31.蔬菜类}`
- **占用列数**：31列（1日~31日）

#### 🥩 鲜肉类支出模块
- **功能**：可选择某年某月的31天鲜肉类每日支出数据
- **操作**：点击模块 → 选择年月份 → 插入31列数据
- **数据格式**：`{2024-12-01.鲜肉类}` 到 `{2024-12-31.鲜肉类}`
- **占用列数**：31列（1日~31日）

#### 其他每日数据模块（均支持年月份选择）
- **冷冻类支出**：31天冷冻类每日支出数据（31列）
- **豆制品类支出**：31天豆制品类每日支出数据（31列）
- **禽蛋类支出**：31天禽蛋类每日支出数据（31列）
- **水果类支出**：31天水果类每日支出数据（31列）
- **点心类支出**：31天点心类每日支出数据（31列）
- **大米支出**：31天大米每日支出数据（31列）
- **面粉制品支出**：31天面粉制品每日支出数据（31列）
- **食用油类支出**：31天食用油类每日支出数据（31列）
- **支出合计**：31天每日支出总计数据（31列）
- **就餐人数**：31天每日就餐人数数据（31列）

### 🧮 汇总统计模块
- **蔬菜类月度合计**：`4,650.00`
- **鲜肉类月度合计**：`8,680.00`
- **冷冻类月度合计**：`2,480.00`
- **月度总合计**：`26,850.00`
- **日均支出**：`865.80`
- **月度就餐总人次**：`1,798`

### 🎨 格式化模块
- **合并标题单元格**：将标题单元格合并居中
- **表头加粗**：设置表头文字为粗体
- **居中对齐**：设置单元格内容居中对齐
- **添加边框**：为选中区域添加边框
- **货币格式**：设置为货币格式显示

## 🎯 使用方法

### 1. 设计报表

#### 每日数据模块（31列）操作
1. **选择目标单元格**：在左侧Luckysheet中点击要插入数据的单元格
2. **点击数据模块**：点击右侧的每日数据模块小卡片
3. **选择年月份**：在弹出的对话框中选择年份和月份
4. **确认插入**：点击"插入数据模块"按钮
5. **自动占用31列**：系统自动将31天的数据插入到连续的31列中

#### 其他模块操作
1. **选择目标单元格**：在左侧Luckysheet中点击要插入数据的单元格
2. **点击模块**：直接点击右侧的汇总或格式化模块
3. **自动插入**：数据自动插入到选中位置

### 2. 31列数据智能处理
- 当你拖拽"每日蔬菜类支出"模块时
- 系统会自动检查是否有足够的31列空间
- 如果空间不足，会提示你选择更靠左的位置
- 成功插入后，会占用连续的31个单元格

### 3. 模板管理
- **保存模板**：设计完成后点击"保存模板"
- **加载模板**：点击"加载模板"重复使用之前的设计
- **导出Excel**：点击"导出Excel"生成标准Excel文件
- **清空**：点击"清空"重新开始设计

## 🎨 设计示例

### 经典食堂报表设计步骤

1. **添加标题**
   - 选择A1单元格
   - 点击"报表标题"模块
   - 使用"合并标题单元格"格式化

2. **添加基础信息**
   - 选择A2单元格，插入"单位名称"
   - 选择F2单元格，插入"填制日期"

3. **设计表头**
   - 手动输入表头：日期、蔬菜类、鲜肉类...
   - 使用"表头加粗"和"居中对齐"格式化

4. **插入每日数据**
   - 选择B5单元格
   - 点击"每日蔬菜类支出"模块（自动占用B5:AF5）
   - 选择B6单元格
   - 点击"每日鲜肉类支出"模块（自动占用B6:AF6）
   - 继续添加其他每日数据...

5. **添加合计行**
   - 在最后一行插入各种汇总模块
   - 使用格式化模块美化样式

6. **保存模板**
   - 点击"保存模板"
   - 输入模板名称和描述

## 🚀 核心优势

### ✅ 独立设计环境
- **专门的设计页面**：不影响月度报表的正常使用
- **专业设计工具**：基于Luckysheet的真正Excel体验
- **完整功能支持**：所有Excel功能都可以使用

### ✅ 智能模块系统
- **31列自动处理**：每日数据模块智能占用31列
- **数据映射**：每个模块对应真实的数据库字段
- **样式区分**：不同类型模块有不同的视觉标识

### ✅ 活字印刷理念
- **模块化组装**：像搭积木一样组装报表
- **拖拽即用**：直观的拖拽操作
- **重复使用**：同一模块可多次使用

### ✅ 完全可视化
- **所见即所得**：设计过程中实时看到效果
- **实时反馈**：立即看到模块插入结果
- **专业导出**：直接导出标准Excel文件

## 🔧 操作技巧

### 快速设计
1. **先规划布局**：确定标题、表头、数据区、合计区的位置
2. **从左到右**：先插入左侧的31列数据，再插入右侧数据
3. **批量格式化**：选中区域后使用格式化模块

### 模块搜索
- 在右侧面板顶部有搜索框
- 可以按模块名称或描述搜索
- 快速找到需要的数据模块

### 空间管理
- 31列数据模块需要足够的水平空间
- 建议从B列开始插入31列数据
- A列用于放置日期或行标题

## 📱 实际应用

### 场景1：标准月度报表
- 包含所有类别的每日数据
- 完整的合计统计
- 标准的签名栏

### 场景2：简化版报表
- 只包含主要类别数据
- 突出重点信息
- 适合快速查看

### 场景3：领导汇报版
- 重点突出汇总数据
- 添加图表和分析
- 美化格式和布局

## 🎉 开始使用

1. **访问页面**：点击左侧菜单"报表设计及导出"
2. **开始设计**：在Luckysheet中选择单元格，然后拖拽或点击右侧模块
3. **保存模板**：设计完成后保存为模板
4. **导出使用**：生成标准Excel文件

**这就是你想要的"活字印刷"式Excel设计体验！** 🎨✨

## 📞 技术支持

如果在使用过程中遇到问题：
1. 确保网络连接正常（Luckysheet需要从CDN加载）
2. 使用Chrome或Firefox最新版浏览器
3. 如果Luckysheet加载失败，请刷新页面重试
4. 联系技术支持获取帮助